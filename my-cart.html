<!DOCTYPE html>
<html lang="en">
<head>
    <title>My cart</title>
    <link rel="stylesheet" type="text/css" href="/src/e-order.css">
    <link rel="icon" type="image/png" href="/images/my-cart.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
</head>
<body>
    <h1>My Cart</h1>
    <button onclick="redirectToMainPage()">Back to Home</button>
    <ul id="cart-items"></ul>

    <!-- <button onclick="convertCartListToArray()">Convert to Array</button>
    <button onclick="convertCartListToCSV()">Convert to CSV</button> -->
    <button onclick="convertCartListToExcel()">Convert to Excel</button>

    <script src="/src/e-order.js"></script>
    <script>
        function displayCartItems() {
            const cartItemsList = document.getElementById('cart-items');
            cartItemsList.innerHTML = '';   // Clearing existing cart items

            cartItems.forEach(item => {
                const listItem = document.createElement('li');
                listItem.textContent = `${item.name} - Quantity: ${item.quantity}`;
                cartItemsList.appendChild(listItem);
            });
        }

        //Converting Cart List into an array
        // function convertCartListToArray() {
        //     const cartListArray = cartItems.map(item => [item.name, item.quantity]);
        //     console.log(cartListArray);
        // }
        
        //Converting Cart List into a csv file
        // function convertCartListToCSV() {
        //     const csvContent = cartItems.map(item => `${item.name},${item.quantity}`).join('\n');
        //     const downloadLink = createDownloadLink(csvContent, 'cart-list.csv');
        //     downloadLink.click();
        // }
        
        //Converting Cart List into excel file
        function convertCartListToExcel() {
            const csvContent = cartItems.map(item => `${item.name},${item.quantity}`).join('\n');
            const excelContent = `data:text/csv;charset=utf-8,\uFEFF${encodeURIComponent(csvContent)}`;
            const downloadLink = createDownloadLink(excelContent, 'cart-list.csv');
            downloadLink.click();
        }

        //Creating download link
        function createDownloadLink(content, filename) {
            const downloadLink = document.createElement('a');
            downloadLink.href = content;
            downloadLink.download = filename;
            return downloadLink;
        }

        // Calling displayCartItems() when the my-cart.html loads
        window.addEventListener('DOMContentLoaded', displayCartItems);
    </script>
</body>
</html>
